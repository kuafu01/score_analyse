import pyodbc

SQLSERVER_CONFIG = {
    'driver': 'ODBC Driver 17 for SQL Server',
    'server': 'localhost',
    'database': 'score_analyse'
}

def get_conn():
    conn_str = (
        f"DRIVER={SQLSERVER_CONFIG['driver']};"
        f"SERVER={SQLSERVER_CONFIG['server']};"
        f"DATABASE={SQLSERVER_CONFIG['database']};"
        "Trusted_Connection=yes;"
    )
    return pyodbc.connect(conn_str)

def insert_test_data():
    conn = get_conn()
    cursor = conn.cursor()
    # 先禁用所有外键约束
    cursor.execute('EXEC sp_msforeachtable "ALTER TABLE ? NOCHECK CONSTRAINT all"')
    # 清空所有表（按依赖顺序）
    cursor.execute('DELETE FROM teacher_class_subject')
    cursor.execute('DELETE FROM study_report')
    cursor.execute('DELETE FROM exam_score')
    cursor.execute('DELETE FROM exam')
    cursor.execute('DELETE FROM student')
    cursor.execute('DELETE FROM class')
    cursor.execute('DELETE FROM teacher')
    cursor.execute('DELETE FROM subject')
    cursor.execute('DELETE FROM [user]')
    conn.commit()
    # 再恢复所有外键约束
    cursor.execute('EXEC sp_msforeachtable "ALTER TABLE ? WITH CHECK CHECK CONSTRAINT all"')

    # 1. 学科
    subjects = [
        ('c0001', '语文', '文科'),
        ('c0002', '数学', '理科'),
        ('c0003', '英语', '外语'),
        ('c0004', '物理', '理科'),
        ('c0005', '化学', '理科'),
        ('c0006', '生物', '理科'),
        ('c0007', '历史', '文科'),
        ('c0008', '地理', '文科'),
        ('c0009', '政治', '文科'),
        ('c0010', '体育', '综合')
    ]
    for sid, name, dept in subjects:
        cursor.execute("INSERT INTO subject (subject_id, subject_name, department) VALUES (?, ?, ?)", sid, name, dept)

    # 2. 教师
    teachers = [
        ('t0001', '张老师', '高级教师', 'c0001', 't0001@school.edu', 1),
        ('t0002', '李老师', '特级教师', 'c0002', 't0002@school.edu', 1),
        ('t0003', '王老师', '一级教师', 'c0003', 't0003@school.edu', 0),
        ('t0004', '刘老师', '物理教师', 'c0004', 't0004@school.edu', 0),
        ('t0005', '陈老师', '化学教师', 'c0005', 't0005@school.edu', 0),
        ('t0006', '赵老师', '生物教师', 'c0006', 't0006@school.edu', 0),
        ('t0007', '孙老师', '历史教师', 'c0007', 't0007@school.edu', 0),
        ('t0008', '周老师', '地理教师', 'c0008', 't0008@school.edu', 0),
        ('t0009', '吴老师', '政治教师', 'c0009', 't0009@school.edu', 0),
        ('t0010', '郑老师', '体育教师', 'c0010', 't0010@school.edu', 0)
    ]
    for tid, name, title, subid, email, is_head in teachers:
        cursor.execute("INSERT INTO teacher (teacher_id, name, title, subject_id, contact_email, is_head_teacher) VALUES (?, ?, ?, ?, ?, ?)", tid, name, title, subid, email, is_head)

    # 3. 班级
    classes = [
        ('cl001', '高一(1)班', 't0001', '高一'),
        ('cl002', '高一(2)班', 't0002', '高一'),
        ('cl003', '高二(1)班', 't0003', '高二')
    ]
    for cid, cname, head_tid, grade in classes:
        cursor.execute("INSERT INTO class (class_id, class_name, head_teacher_id, grade_level) VALUES (?, ?, ?, ?)", cid, cname, head_tid, grade)

    # 4. 学生
    students = [
        ('s0001', '张三', '男', '2008-03-15', 'cl001', '13800138001', '张父-13900139001'),
        ('s0002', '李四', '男', '2008-05-22', 'cl001', '13800138002', '李母-13900139002'),
        ('s0003', '王芳', '女', '2008-02-10', 'cl001', '13800138003', '王父-13900139003'),
        ('s0004', '赵敏', '女', '2008-07-30', 'cl002', '13800138004', '赵母-13900139004'),
        ('s0005', '刘强', '男', '2008-11-05', 'cl002', '13800138005', '刘父-13900139005'),
        ('s0006', '陈雪', '女', '2007-09-18', 'cl003', '13800138006', '陈母-13900139006'),
        ('s0007', '杨帆', '男', '2007-04-25', 'cl003', '13800138007', '杨父-13900139007'),
        ('s0008', '周婷', '女', '2007-12-12', 'cl003', '13800138008', '周母-13900139008'),
        ('s0009', '吴昊', '男', '2007-08-08', 'cl003', '13800138009', '吴父-13900139009'),
        ('s0010', '郑阳', '男', '2007-06-20', 'cl003', '13800138010', '郑母-13900139010')
    ]
    for sid, name, gender, birth, cid, phone, emer in students:
        cursor.execute("INSERT INTO student (student_id, name, gender, birth_date, class_id, contact_phone, emergency_contact) VALUES (?, ?, ?, ?, ?, ?, ?)", sid, name, gender, birth, cid, phone, emer)

    # 5. 用户
    users = [
        # 学生
        ('u0001', 's0001', '123456', 'student', '张三'),
        ('u0002', 's0002', '123456', 'student', '李四'),
        ('u0003', 's0003', '123456', 'student', '王芳'),
        ('u0004', 's0004', '123456', 'student', '赵敏'),
        ('u0005', 's0005', '123456', 'student', '刘强'),
        ('u0006', 's0006', '123456', 'student', '陈雪'),
        ('u0007', 's0007', '123456', 'student', '杨帆'),
        ('u0008', 's0008', '123456', 'student', '周婷'),
        ('u0009', 's0009', '123456', 'student', '吴昊'),
        ('u0010', 's0010', '123456', 'student', '郑阳'),
        # 教师
        ('u0011', 't0001', '123456', 'classmaster', '张老师'),
        ('u0012', 't0002', '123456', 'classmaster', '李老师'),
        ('u0013', 't0003', '123456', 'classmaster', '王老师'),
        ('u0014', 't0004', '123456', 'teacher', '刘老师'),
        ('u0015', 't0005', '123456', 'teacher', '陈老师'),
        ('u0016', 't0006', '123456', 'teacher', '赵老师'),
        ('u0017', 't0007', '123456', 'teacher', '孙老师'),
        ('u0018', 't0008', '123456', 'teacher', '周老师'),
        ('u0019', 't0009', '123456', 'teacher', '吴老师'),
        ('u0020', 't0010', '123456', 'teacher', '郑老师')
    ]
    for uid, uname, pwd, role, name in users:
        cursor.execute("INSERT INTO [user] (user_id, username, password, role, name) VALUES (?, ?, ?, ?, ?)", uid, uname, pwd, role, name)

    # 6. 考试
    exams = [
        ('ex001', '2025学年期中考试', '期中', '2025-04-10'),
        ('ex002', '2025学年期末考试', '期末', '2025-06-20'),
        ('ex003', '2025年3月月考', '月考', '2025-03-05'),
        ('ex004', '2025年5月月考', '月考', '2025-05-08'),
        ('ex005', '2025高考模拟考', '模拟', '2025-05-25')
    ]
    for eid, ename, etype, edate in exams:
        cursor.execute("INSERT INTO exam (exam_id, exam_name, exam_type, exam_date) VALUES (?, ?, ?, ?)", eid, ename, etype, edate)

    # 7. 部分考试成绩
    scores = [
        # s0001
        ('sc0001', 's0001', 'ex001', 'c0001', 85.5, 3, '2025-04-10'),
        ('sc0002', 's0001', 'ex001', 'c0002', 92.0, 1, '2025-04-10'),
        ('sc0003', 's0001', 'ex001', 'c0003', 78.0, 5, '2025-04-10'),
        ('sc0004', 's0001', 'ex002', 'c0001', 88.0, 2, '2025-06-20'),
        ('sc0005', 's0001', 'ex002', 'c0002', 94.5, 1, '2025-06-20'),
        ('sc0015', 's0001', 'ex001', 'c0004', 87.5, 4, '2025-04-10'),
        ('sc0016', 's0001', 'ex001', 'c0005', 85.0, 5, '2025-04-10'),
        ('sc0017', 's0001', 'ex001', 'c0006', 88.0, 3, '2025-04-10'),
        ('sc0018', 's0001', 'ex001', 'c0007', 92.5, 2, '2025-04-10'),
        ('sc0019', 's0001', 'ex001', 'c0008', 89.0, 4, '2025-04-10'),
        ('sc0020', 's0001', 'ex001', 'c0009', 91.0, 3, '2025-04-10'),
        ('sc0021', 's0001', 'ex001', 'c0010', 94.0, 1, '2025-04-10'),
        ('sc0022', 's0001', 'ex002', 'c0003', 83.5, 5, '2025-06-20'),
        ('sc0023', 's0001', 'ex002', 'c0004', 86.0, 4, '2025-06-20'),
        ('sc0024', 's0001', 'ex002', 'c0005', 88.5, 3, '2025-06-20'),
        ('sc0025', 's0001', 'ex002', 'c0006', 90.0, 2, '2025-06-20'),
        ('sc0026', 's0001', 'ex002', 'c0007', 92.0, 1, '2025-06-20'),
        ('sc0027', 's0001', 'ex002', 'c0008', 87.0, 3, '2025-06-20'),
        ('sc0028', 's0001', 'ex002', 'c0009', 89.5, 2, '2025-06-20'),
        ('sc0029', 's0001', 'ex002', 'c0010', 93.5, 1, '2025-06-20'),
        ('sc0030', 's0001', 'ex003', 'c0001', 84.0, 4, '2025-03-05'),
        ('sc0031', 's0001', 'ex003', 'c0002', 89.5, 3, '2025-03-05'),
        ('sc0032', 's0001', 'ex003', 'c0003', 82.0, 5, '2025-03-05'),
        ('sc0033', 's0001', 'ex003', 'c0004', 86.5, 4, '2025-03-05'),
        ('sc0034', 's0001', 'ex003', 'c0005', 88.0, 3, '2025-03-05'),
        ('sc0035', 's0001', 'ex003', 'c0006', 91.5, 2, '2025-03-05'),
        ('sc0036', 's0001', 'ex003', 'c0007', 93.0, 1, '2025-03-05'),
        ('sc0037', 's0001', 'ex003', 'c0008', 87.5, 3, '2025-03-05'),
        ('sc0038', 's0001', 'ex003', 'c0009', 90.0, 2, '2025-03-05'),
        ('sc0039', 's0001', 'ex003', 'c0010', 94.5, 1, '2025-03-05'),
        ('sc0040', 's0001', 'ex004', 'c0001', 85.5, 4, '2025-05-08'),
        ('sc0041', 's0001', 'ex004', 'c0002', 90.0, 3, '2025-05-08'),
        ('sc0042', 's0001', 'ex004', 'c0003', 83.0, 5, '2025-05-08'),
        ('sc0043', 's0001', 'ex004', 'c0004', 88.0, 4, '2025-05-08'),
        ('sc0044', 's0001', 'ex004', 'c0005', 89.5, 3, '2025-05-08'),
        ('sc0045', 's0001', 'ex004', 'c0006', 92.0, 2, '2025-05-08'),
        ('sc0046', 's0001', 'ex004', 'c0007', 94.0, 1, '2025-05-08'),
        ('sc0047', 's0001', 'ex004', 'c0008', 86.5, 4, '2025-05-08'),
        ('sc0048', 's0001', 'ex004', 'c0009', 91.0, 3, '2025-05-08'),
        ('sc0049', 's0001', 'ex004', 'c0010', 95.0, 1, '2025-05-08'),
        ('sc0050', 's0001', 'ex005', 'c0001', 86.0, 4, '2025-05-25'),
        ('sc0051', 's0001', 'ex005', 'c0002', 91.5, 3, '2025-05-25'),
        ('sc0052', 's0001', 'ex005', 'c0003', 84.5, 5, '2025-05-25'),
        ('sc0053', 's0001', 'ex005', 'c0004', 89.0, 4, '2025-05-25'),
        ('sc0054', 's0001', 'ex005', 'c0005', 90.5, 3, '2025-05-25'),
        ('sc0055', 's0001', 'ex005', 'c0006', 93.0, 2, '2025-05-25'),
        ('sc0056', 's0001', 'ex005', 'c0007', 95.0, 1, '2025-05-25'),
        ('sc0057', 's0001', 'ex005', 'c0008', 88.0, 4, '2025-05-25'),
        ('sc0058', 's0001', 'ex005', 'c0009', 92.5, 3, '2025-05-25'),
        ('sc0059', 's0001', 'ex005', 'c0010', 96.0, 1, '2025-05-25'),
        # s0002
        ('sc0006', 's0002', 'ex001', 'c0001', 90.0, 2, '2025-04-10'),
        ('sc0007', 's0002', 'ex001', 'c0002', 88.5, 3, '2025-04-10'),
        ('sc0008', 's0002', 'ex002', 'c0001', 92.5, 1, '2025-06-20'),
        ('sc0009', 's0002', 'ex002', 'c0002', 90.0, 2, '2025-06-20'),
        # s0010
        ('sc0010', 's0010', 'ex005', 'c0010', 95.0, 1, '2025-05-25'),
        # s0003
        ('sc0011', 's0003', 'ex001', 'c0001', 82.5, 4, '2025-04-10'),
        ('sc0012', 's0003', 'ex002', 'c0001', 85.0, 3, '2025-06-20'),
        # s0004
        ('sc0013', 's0004', 'ex001', 'c0002', 86.0, 4, '2025-04-10'),
        ('sc0014', 's0004', 'ex002', 'c0002', 89.5, 3, '2025-06-20'),
    ]
    for scid, sid, eid, subid, score, rank, cdate in scores:
        cursor.execute("INSERT INTO exam_score (score_id, student_id, exam_id, subject_id, score, ranking, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)", scid, sid, eid, subid, score, rank, cdate)

    # 7. 补充cl001班多学生多学科多分档成绩
    more_scores = [
        # s0002
        ('sc1001', 's0002', 'ex001', 'c0001', 95, 1, '2025-04-10'),  # 语文A
        ('sc1002', 's0002', 'ex001', 'c0002', 80, 2, '2025-04-10'),  # 数学B
        ('sc1003', 's0002', 'ex001', 'c0003', 65, 3, '2025-04-10'),  # 英语C
        ('sc1004', 's0002', 'ex002', 'c0001', 55, 4, '2025-06-20'),  # 语文D
        ('sc1005', 's0002', 'ex002', 'c0002', 78, 2, '2025-06-20'),  # 数学B
        ('sc1006', 's0002', 'ex002', 'c0003', 88, 1, '2025-06-20'),  # 英语A
        ('sc1007', 's0002', 'ex003', 'c0001', 72, 3, '2025-03-05'),  # 语文C
        ('sc1008', 's0002', 'ex003', 'c0002', 91, 1, '2025-03-05'),  # 数学A
        ('sc1009', 's0002', 'ex003', 'c0003', 59, 4, '2025-03-05'),  # 英语D
        # s0003
        ('sc1010', 's0003', 'ex001', 'c0001', 77, 2, '2025-04-10'),  # 语文B
        ('sc1011', 's0003', 'ex001', 'c0002', 62, 3, '2025-04-10'),  # 数学C
        ('sc1012', 's0003', 'ex001', 'c0003', 58, 4, '2025-04-10'),  # 英语D
        ('sc1013', 's0003', 'ex002', 'c0001', 89, 1, '2025-06-20'),  # 语文A
        ('sc1014', 's0003', 'ex002', 'c0002', 74, 2, '2025-06-20'),  # 数学C
        ('sc1015', 's0003', 'ex002', 'c0003', 79, 3, '2025-06-20'),  # 英语B
        ('sc1016', 's0003', 'ex003', 'c0001', 61, 4, '2025-03-05'),  # 语文C
        ('sc1017', 's0003', 'ex003', 'c0002', 55, 4, '2025-03-05'),  # 数学D
        ('sc1018', 's0003', 'ex003', 'c0003', 92, 1, '2025-03-05'),  # 英语A
    ]
    for scid, sid, eid, subid, score, rank, cdate in more_scores:
        cursor.execute("INSERT INTO exam_score (score_id, student_id, exam_id, subject_id, score, ranking, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)", scid, sid, eid, subid, score, rank, cdate)
    # 8. 学习报告
    # s0001每次考试每科均有报告，日期与考试日期一致
    reports = []
    exam_teacher_map = {
        'ex001': [
            ('c0001', 't0001', '语文基础扎实，作文表达能力突出，需加强文言文阅读'),
            ('c0002', 't0002', '数学逻辑思维强，解题速度快，但需注意计算细节'),
            ('c0003', 't0003', '英语听说俱佳，阅读需加强'),
            ('c0004', 't0004', '物理基础扎实，实验能力突出'),
            ('c0005', 't0005', '化学反应原理掌握好，需多做题'),
            ('c0006', 't0006', '生物知识点掌握全面'),
            ('c0007', 't0007', '历史事件分析透彻'),
            ('c0008', 't0008', '地理图表判读能力强'),
            ('c0009', 't0009', '政治理论基础扎实'),
            ('c0010', 't0010', '体育积极参与，体能优秀')
        ],
        'ex002': [
            ('c0001', 't0001', '语文阅读能力提升明显'),
            ('c0002', 't0002', '数学计算细致，逻辑性强'),
            ('c0003', 't0003', '英语写作能力进步大'),
            ('c0004', 't0004', '物理题目分析能力增强'),
            ('c0005', 't0005', '化学实验操作规范'),
            ('c0006', 't0006', '生物实验设计有创新'),
            ('c0007', 't0007', '历史知识点记忆牢固'),
            ('c0008', 't0008', '地理区域认知能力提升'),
            ('c0009', 't0009', '政治时事关注度高'),
            ('c0010', 't0010', '体育成绩持续优秀')
        ],
        'ex003': [
            ('c0001', 't0001', '语文作文立意新颖'),
            ('c0002', 't0002', '数学思维活跃'),
            ('c0003', 't0003', '英语词汇量丰富'),
            ('c0004', 't0004', '物理公式运用熟练'),
            ('c0005', 't0005', '化学方程式书写规范'),
            ('c0006', 't0006', '生物实验观察细致'),
            ('c0007', 't0007', '历史材料分析能力强'),
            ('c0008', 't0008', '地理案例分析到位'),
            ('c0009', 't0009', '政治观点表达清晰'),
            ('c0010', 't0010', '体育锻炼积极主动')
        ],
        'ex004': [
            ('c0001', 't0001', '语文古诗文积累丰富'),
            ('c0002', 't0002', '数学解题速度提升'),
            ('c0003', 't0003', '英语语法掌握扎实'),
            ('c0004', 't0004', '物理实验探究能力强'),
            ('c0005', 't0005', '化学知识点掌握牢固'),
            ('c0006', 't0006', '生物遗传题表现优异'),
            ('c0007', 't0007', '历史答题条理清晰'),
            ('c0008', 't0008', '地理环境分析能力突出'),
            ('c0009', 't0009', '政治理论联系实际'),
            ('c0010', 't0010', '体育技能全面发展')
        ],
        'ex005': [
            ('c0001', 't0001', '语文表达能力持续进步'),
            ('c0002', 't0002', '数学综合运用能力强'),
            ('c0003', 't0003', '英语听力理解能力提升'),
            ('c0004', 't0004', '物理计算题准确率高'),
            ('c0005', 't0005', '化学实验题得分高'),
            ('c0006', 't0006', '生物知识迁移能力强'),
            ('c0007', 't0007', '历史大题分析有深度'),
            ('c0008', 't0008', '地理综合题表现优良'),
            ('c0009', 't0009', '政治论述条理清楚'),
            ('c0010', 't0010', '体育专项能力突出')
        ]
    }
    exam_dates = {
        'ex001': '2025-04-10',
        'ex002': '2025-06-20',
        'ex003': '2025-03-05',
        'ex004': '2025-05-08',
        'ex005': '2025-05-25',
    }
    report_id = 1000
    for eid, teacher_list in exam_teacher_map.items():
        for subid, tid, content in teacher_list:
            report_id += 1
            reports.append((f'rp{report_id}', 's0001', tid, exam_dates[eid], content, 'A'))
    for rid, sid, tid, rdate, content, level in reports:
        cursor.execute("INSERT INTO study_report (report_id, student_id, teacher_id, report_date, content, evaluation_level) VALUES (?, ?, ?, ?, ?, ?)", rid, sid, tid, rdate, content, level)

    # 9. 教师班级任课
    tcs = [
        ('r0001', 't0001', 'cl001', 'c0001'),
        ('r0002', 't0002', 'cl001', 'c0002'),
        ('r0003', 't0003', 'cl001', 'c0003'),
        ('r0004', 't0004', 'cl002', 'c0004'),
        ('r0005', 't0005', 'cl002', 'c0005'),
        ('r0006', 't0006', 'cl003', 'c0006'),
        ('r0007', 't0007', 'cl003', 'c0007'),
        ('r0008', 't0008', 'cl003', 'c0008'),
        ('r0009', 't0009', 'cl003', 'c0009'),
        ('r0010', 't0010', 'cl003', 'c0010')
    ]
    for relid, tid, cid, subid in tcs:
        cursor.execute("INSERT INTO teacher_class_subject (relation_id, teacher_id, class_id, subject_id) VALUES (?, ?, ?, ?)", relid, tid, cid, subid)

    # 10. 班级成绩分析报告
    class_exam_reports = [
        ('cr001', 't0001', 'cl001', 'ex001', '高一(1)班2025期中考试整体表现良好，语文平均分85，数学突出，需加强英语学习。'),
        ('cr002', 't0001', 'cl001', 'ex002', '高一(1)班2025期末考试整体进步明显，数学和物理成绩提升较大。'),
        ('cr003', 't0002', 'cl002', 'ex001', '高一(2)班2025期中考试整体成绩中等，部分学生需加强基础知识。'),
        ('cr004', 't0003', 'cl003', 'ex003', '高二(1)班2025年3月月考理科成绩优秀，文科需提升。'),
        # 新增数据
        ('cr005', 't0002', 'cl002', 'ex002', '高一(2)班2025期末考试整体进步，数学平均分提升，英语仍需努力。'),
        ('cr006', 't0003', 'cl003', 'ex004', '高二(1)班2025年5月月考班级整体稳定，部分学生成绩波动较大。'),
        ('cr007', 't0001', 'cl001', 'ex003', '高一(1)班2025年3月月考语文成绩优秀，需关注理科短板。'),
        ('cr008', 't0004', 'cl002', 'ex001', '高一(2)班物理成绩整体良好，实验题得分高。')
    ]
    for rid, tid, cid, eid, content in class_exam_reports:
        cursor.execute("INSERT INTO class_exam_report (report_id, teacher_id, class_id, exam_id, content) VALUES (?, ?, ?, ?, ?)", rid, tid, cid, eid, content)

    # t0010（体育教师，cl003班）补充体育成绩，覆盖A/B/C/D分布（全部在ex005高考模拟考）
    pe_scores_ex005 = [
        ('sc3001', 's0006', 'ex005', 'c0010', 95, 1, '2025-05-25'),  # A
        ('sc3002', 's0007', 'ex005', 'c0010', 80, 2, '2025-05-25'),  # B
        ('sc3003', 's0008', 'ex005', 'c0010', 65, 3, '2025-05-25'),  # C
        ('sc3004', 's0009', 'ex005', 'c0010', 55, 4, '2025-05-25'),  # D
    ]
    for scid, sid, eid, subid, score, rank, cdate in pe_scores_ex005:
        cursor.execute("INSERT INTO exam_score (score_id, student_id, exam_id, subject_id, score, ranking, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)", scid, sid, eid, subid, score, rank, cdate)

    # cl003班体育多考试多学生多分档成绩，便于折线图展示
    pe_scores_history = [
        # ex001
        ('sc4001', 's0006', 'ex001', 'c0010', 92, 1, '2025-04-10'),
        ('sc4002', 's0007', 'ex001', 'c0010', 78, 2, '2025-04-10'),
        ('sc4003', 's0008', 'ex001', 'c0010', 65, 3, '2025-04-10'),
        ('sc4004', 's0009', 'ex001', 'c0010', 58, 4, '2025-04-10'),
        # ex002
        ('sc4005', 's0006', 'ex002', 'c0010', 88, 1, '2025-06-20'),
        ('sc4006', 's0007', 'ex002', 'c0010', 75, 2, '2025-06-20'),
        ('sc4007', 's0008', 'ex002', 'c0010', 62, 3, '2025-06-20'),
        ('sc4008', 's0009', 'ex002', 'c0010', 55, 4, '2025-06-20'),
        # ex003
        ('sc4009', 's0006', 'ex003', 'c0010', 95, 1, '2025-03-05'),
        ('sc4010', 's0007', 'ex003', 'c0010', 80, 2, '2025-03-05'),
        ('sc4011', 's0008', 'ex003', 'c0010', 65, 3, '2025-03-05'),
        ('sc4012', 's0009', 'ex003', 'c0010', 59, 4, '2025-03-05'),
        # ex004
        ('sc4013', 's0006', 'ex004', 'c0010', 90, 1, '2025-05-08'),
        ('sc4014', 's0007', 'ex004', 'c0010', 76, 2, '2025-05-08'),
        ('sc4015', 's0008', 'ex004', 'c0010', 61, 3, '2025-05-08'),
        ('sc4016', 's0009', 'ex004', 'c0010', 56, 4, '2025-05-08'),
        # ex005（已补充过A/B/C/D，略）
    ]
    for scid, sid, eid, subid, score, rank, cdate in pe_scores_history:
        cursor.execute("INSERT INTO exam_score (score_id, student_id, exam_id, subject_id, score, ranking, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)", scid, sid, eid, subid, score, rank, cdate)

    conn.commit()
    cursor.close()
    conn.close()
    print('测试数据插入完成！')

if __name__ == '__main__':
    insert_test_data()
